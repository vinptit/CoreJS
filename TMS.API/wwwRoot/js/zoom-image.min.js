("use strict");
function zoom() {
    const image = document.querySelector(".dark-overlay img");
    const btnRoLeft = document.querySelector(".ro-left");
    const btnRoRight = document.querySelector(".ro-right");
    let scale = 1;
    const SCALE_FACTOR = 0.1;
    let currentRotation = 0;
    let isDragging = false;
    let startX, startY, translateX = 0, translateY = 0;

    btnRoRight.addEventListener('click', function (e) {
        e.preventDefault();
        currentRotation += 90;
        updateTransform();
    });

    btnRoLeft.addEventListener('click', function (e) {
        e.preventDefault();
        currentRotation -= 90;
        updateTransform();
    });

    image.addEventListener("mousewheel", function (e) {
        e.preventDefault();
        let rotate = `rotate(${currentRotation}deg)`;
        scale += e.deltaY > 0 ? -SCALE_FACTOR : SCALE_FACTOR;
        scale = Math.min(Math.max(1, scale), 6);
        updateTransform();
    });

    image.addEventListener('mousedown', function (e) {
        e.preventDefault();
        isDragging = true;
        startX = e.clientX;
        startY = e.clientY;
    });

    document.addEventListener('mousemove', function (e) {
        if (isDragging) {
            const currentX = e.clientX;
            const currentY = e.clientY;

            const deltaX = (currentX - startX);
            const deltaY = (currentY - startY);

            const radian = currentRotation * (Math.PI / 180);
            const cosAngle = Math.cos(radian);
            const sinAngle = Math.sin(radian);

            const rotatedDeltaX = deltaX * cosAngle + deltaY * sinAngle;
            const rotatedDeltaY = -deltaX * sinAngle + deltaY * cosAngle;

            translateX += rotatedDeltaX / scale;
            translateY += rotatedDeltaY / scale;

            updateTransform();

            startX = currentX;
            startY = currentY;
        }
    });

    document.addEventListener('mouseup', function () {
        isDragging = false;
    });

    function updateTransform() {
        let rotate = `rotate(${currentRotation}deg)`;
        image.style.transform = `${rotate} scale(${scale}) translate(${translateX}px, ${translateY}px)`;
    }
}

const image = document.querySelector(".dark-overlay img");
if (image != null) {
    zoom();
}